---
title: '[React] MSWë¡œ API Mocking í•˜ê¸°'
author: 'Eunwoo'
thumbnail: '/thumbnail/etc/msw.webp'
publishDate: '2025-05-21'
categoryId: 6
---

ê°œë°œ ì´ˆê¸°, ìì‹ ì´ í”„ë¡ íŠ¸ì—”ë“œë¼ë©´ ë°±ì—”ë“œë¡œë¶€í„° APIê°€ ì•„ì§ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ê±°ë‚˜ ì™¸ë¶€ API í˜¸ì¶œì— ì˜ì¡´ì ì´ë¼ë©´ ê°œë°œ ì†ë„ê°€ ëŠë ¤ì§ˆ ìˆ˜ ìˆë‹¤.
API ëª¨í‚¹ì„ í†µí•´ ì‹¤ì œ ë°±ì—”ë“œ ì„œë¹„ìŠ¤ ì—†ì´ë„ í”„ë¡ íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë™ì‘ì„ ì‹œë®¬ë ˆì´ì…˜í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— MSWëŠ” ë§¤ìš° ìœ ìš©í•˜ë‹¤.
ì´ëŸ´ ë•Œ `MSW(Mock Service Worker)`ë¥¼ ì‚¬ìš©í•˜ë©´, ì‹¤ì œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ê°€ë¡œì±„ì„œ ì›í•˜ëŠ” ì‘ë‹µì„ ë§Œë“¤ì–´ì£¼ëŠ” ê°€ì§œ ì„œë²„ í™˜ê²½ì„ êµ¬ì„±í•  ìˆ˜ ìˆì–´ ë§¤ìš° ìœ ìš©í•˜ë‹¤.

í•´ë‹¹ ë‚´ìš©ì€ [MSW ê³µì‹ë¬¸ì„œ](https://mswjs.io/docs/getting-started)ë¥¼ ì°¸ê³ í•˜ì—¬ ì‘ì„±í•˜ì˜€ë‹¤.

ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Vite + React í™˜ê²½ì—ì„œ MSWë¥¼ ì ìš©í•˜ëŠ” ë°©ë²•ì„ ìì„¸íˆ ì•Œì•„ë³´ì.

# MSWë€?

`MSW(Mock Service Worker)`ëŠ” ë¸Œë¼ìš°ì €ì˜ Service Worker APIë¥¼ í™œìš©í•´ ì‹¤ì œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ê°€ë¡œì±„ê³ , ìš°ë¦¬ê°€ ì •ì˜í•œ ê°€ì§œ ì‘ë‹µ(mock response)ìœ¼ë¡œ ëŒ€ì²´í•´ì£¼ëŠ” API Mocking ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.

## MSWë¥¼ ì–¸ì œ ì‚¬ìš©í•´ì•¼ í• ê¹Œ?

- ë°±ì—”ë“œ APIê°€ ì•„ì§ ì™„ì„±ë˜ì§€ ì•ŠìŒ
- íŒ€ ë‚´ í”„ë¡ íŠ¸/ë°±ì—”ë“œ ê°œë°œ ì†ë„ ë¶ˆì¼ì¹˜
- ì™¸ë¶€ APIì— ì˜ì¡´ì„±ì´ ìˆì–´ ê°œë°œ ì¤‘ë‹¨
- í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ì‹¤ì œ API í˜¸ì¶œì´ ë¶€ë‹´ë¨

ìœ„ì™€ ê°™ì€ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ëŒ€ì•ˆ ì¤‘ ê°€ì¥ ì´ìƒì ì¸ ë„êµ¬ê°€ ë°”ë¡œ `MSW(Mock Service Worker)`ì´ë‹¤.

# MSWì˜ ì£¼ìš” ì¥ì 

- ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤ì œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì²˜ëŸ¼ ì‘ë™ (fetch/XHR ëª¨ë‘ ì§€ì›)
- API ë ˆë²¨ì—ì„œ ìš”ì²­ì„ ê°€ë¡œì±„ê¸° ë•Œë¬¸ì— UIëŠ” ê·¸ëŒ€ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- ê°œë°œ, í…ŒìŠ¤íŠ¸, ìŠ¤í† ë¦¬ë¶ í™˜ê²½ ëª¨ë‘ ì§€ì›
- RESTë¿ ì•„ë‹ˆë¼ GraphQLë„ ì§€ì›

# MSW ì„¸íŒ…í•˜ê¸°

## 1. MSW ì„¤ì¹˜

```bash
npm install msw@latest --save-dev
```

## 2. Service Worker íŒŒì¼ ìƒì„±

MSWëŠ” Service Workerë¥¼ ì‚¬ìš©í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ê°€ë¡œì±„ê¸° ë•Œë¬¸ì—, ë¨¼ì € Service Worker íŒŒì¼ì„ ìƒì„±í•´ì•¼ í•œë‹¤.

ì•„ë˜ ëª…ë ¹ì–´ë¡œ MSWì˜ ì„œë¹„ìŠ¤ ì›Œì»¤ íŒŒì¼ì„ ìƒì„±í•œë‹¤.

ì´ ëª…ë ¹ì€ public/mockServiceWorker.js íŒŒì¼ì„ ìƒì„±í•œë‹¤.

- public/ í´ë”ì— ë„£ëŠ” ì´ìœ : ì´ í´ë” ì•ˆì˜ íŒŒì¼ì€ Viteì—ì„œ ë£¨íŠ¸ ê²½ë¡œ(/)ì— ê·¸ëŒ€ë¡œ ë…¸ì¶œëœë‹¤.
- ìƒì„±ëœ íŒŒì¼ì€ ìë™ìœ¼ë¡œ /mockServiceWorker.js ê²½ë¡œì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•´ì§„ë‹¤.

```bash
npx msw init public --save
```

ì„œë¹„ìŠ¤ ì›Œì»¤ íŒŒì¼ì„ ìƒì„±í•œ í›„ì—ëŠ” ë°˜ë“œì‹œ Vite dev ì„œë²„ë¥¼ ë‹¤ì‹œ ì‹œì‘í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

# MSW í´ë” êµ¬ì¡°

MSWë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í•„ìš”í•œ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
ë³¸ì¸ì€ dummy.json íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ë”ë¯¸ ë°ì´í„°ë¥¼ ë§Œë“¤ê³ , handlers.tsì—ì„œ API ëª¨í‚¹ì„ ì •ì˜í•˜ì˜€ë‹¤.

```bash
src/
â”œâ”€â”€ mocks/
â”œâ”€â”€ â”œâ”€â”€ dummy.json      // ë”ë¯¸ ë°ì´í„°
â”‚   â”œâ”€â”€ handlers.ts     // API ëª¨í‚¹ ì •ì˜
â”‚   â”œâ”€â”€ browser.ts      // ë¸Œë¼ìš°ì €ìš© MSW ì„¤ì •
â”‚   â””â”€â”€ server.ts       // í…ŒìŠ¤íŠ¸ìš© MSW ì„¤ì • (Node í™˜ê²½)
â”œâ”€â”€ setupTests.ts       // í…ŒìŠ¤íŠ¸ í™˜ê²½ ì´ˆê¸°í™”
â””â”€â”€ main.tsx            // ê°œë°œ ì¤‘ MSW ì‹¤í–‰
```

# handlers.ts

`handlers.ts` ëŠ” ì–´ë–¤ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ì–´ë–¤ ì‘ë‹µì„ ì¤„ì§€ë¥¼ ì •ì˜í•˜ëŠ” ê³³ì´ë‹¤.

- ğŸ“„ src/mocks/dummy.ts

```json
[
  {
    "user": "Levi",
    "role": "FE"
  },
  {
    "user": "Kevin",
    "role": "BE"
  },
  {
    "user": "Bree",
    "role": "Designer"
  }
]
```

- ğŸ“„ src/mocks/handlers.ts

```ts
import { HttpResponse, http } from 'msw';
import dummy from './dummy.json';

export const handlers = [
  http.get('/api/user', () => {
    return HttpResponse.json(dummy);
  }),
];
```

# browser.ts

`browser.ts`ëŠ” ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ MSWë¥¼ ì„¤ì •í•˜ëŠ” ê³³ì´ë‹¤. `setupWorker`ë¥¼ ì‚¬ìš©í•˜ì—¬ Service Workerë¥¼ ë“±ë¡í•˜ê³ , `handlers.ts`ì—ì„œ ì •ì˜í•œ í•¸ë“¤ëŸ¬ë¥¼ ì—°ê²°í•œë‹¤.

- ğŸ“„ src/mocks/browser.ts

```ts
import { setupWorker } from 'msw/browser';
import { handlers } from './handlers';

export const worker = setupWorker(...handlers);
```

# ê°œë°œ í™˜ê²½ì—ì„œ MSW ì‹¤í–‰

- ğŸ“„ src/main.tsx

```ts
 import React from "react";
 import ReactDOM from "react-dom/client";
 import App from "./App.tsx";

 async function enableMocking() {
   if (process.env.NODE_ENV !== "development") {
     return;
   }

   const { worker } = await import("./mocks/browser"); // Dynamic import
   return worker.start();
 }

 enableMocking().then(() => {
   ReactDOM.createRoot(document.getElementById("root") as HTMLElement).render(
     <React.StrictMode>
       <App />
     </React.StrictMode>
   );
 });
```

ìœ„ ì½”ë“œëŠ” ê°œë°œ(dev) í™˜ê²½ì—ì„œë§Œ MSWë¥¼ ì‹¤í–‰í•˜ë„ë¡ ì„¤ì •í•œë‹¤.

![](https://velog.velcdn.com/images/eunwoo1341/post/8b528e13-ca57-4e74-9c1b-bd3c841b0d31/image.png)

ì •ìƒì ìœ¼ë¡œ MSWë¥¼ í†µí•´ Mockingì´ ì™„ë£Œë˜ë©´, ìœ„ì™€ ê°™ì´ ë¸Œë¼ìš°ì €ì˜ ê°œë°œì ë„êµ¬ì—ì„œ Console íƒ­ì—ì„œ ì„±ê³µí•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

ì´ì œ React ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œë¥¼ ì‚´í´ë³´ì.

- ğŸ“„ src/App.tsx

```ts
import { useEffect, useState } from 'react';

function App() {
  const [user, setUser] = useState(null);

  useEffect(() => {
    fetch('/api/user')
      .then((res) => res.json())
      .then(setUser);
  }, []);

  return (
    <div>
      <h1>ì‚¬ìš©ì ì •ë³´</h1>
      {user ? (
        <p>
          {user.name} ({user.role})
        </p>
      ) : (
        <p>ë¡œë”© ì¤‘...</p>
      )}
    </div>
  );
}

export default App;
```

ìœ„ ì½”ë“œì™€ ê°™ì´ `/api/user` ì—”ë“œí¬ì¸íŠ¸ì— GET ìš”ì²­ì„ ë³´ë‚´ë©´, `MSW`ê°€ /api/user ìš”ì²­ì„ ê°€ë¡œì±„ê³ , ë”°ë¡œ ì •ì˜í•œ JSONì„ ì‘ë‹µí•©ë‹ˆë‹¤.

# í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ MSW ì‹¤í–‰

`MSW`ëŠ” í…ŒìŠ¤íŠ¸ì—ì„œë„ ë™ì¼í•œ ìš”ì²­ ê°€ë¡œì±„ê¸°ë¥¼ ì œê³µí•œë‹¤.
í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œëŠ” `setupServer`ë¥¼ ì‚¬ìš©í•˜ì—¬ Node.js í™˜ê²½ì—ì„œ MSWë¥¼ ì„¤ì •í•œë‹¤.

í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ MSWë¥¼ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì„ ì†Œê°œí•˜ê¸° ì•ì„œ, Reactì—ì„œ [React Testing Library (RTL)](https://testing-library.com/docs/react-testing-library/intro/)ë¥¼ ë¨¼ì € ì„¤ì¹˜í•˜ì—¬ ì¤€ë¹„í•´ë³´ì.

```bash
npm install --save-dev @testing-library/react @testing-library/dom

```

Typescriptë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ì•„ë˜ì™€ ê°™ì´ íƒ€ì… ì •ì˜ë„ ì„¤ì¹˜í•´ì¤€ë‹¤.

```bash
@types/react @types/react-dom
```

## server.ts

- ğŸ“„ src/mocks/server.ts

```ts
import { setupServer } from 'msw/node';
import { handlers } from './handlers';

export const server = setupServer(...handlers);
```

`server.ts`ëŠ” Node.ts í™˜ê²½ì—ì„œ MSWë¥¼ ì„¤ì •í•˜ëŠ” ê³³ì´ë‹¤. `setupServer`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ë¥¼ ì„¤ì •í•˜ê³ , `handlers.ts`ì—ì„œ ì •ì˜í•œ í•¸ë“¤ëŸ¬ë¥¼ ì—°ê²°í•œë‹¤.

- ğŸ“„ src/setupTests.ts

```ts
import { server } from './mocks/server';

beforeAll(() => server.listen());
afterEach(() => server.resetHandlers());
afterAll(() => server.close());
```

- ğŸ“„ vite.config.ts í…ŒìŠ¤íŠ¸ ì„¤ì • ì¶”ê°€

```ts
import { defineConfig } from 'vitest/config'; //  vitest ì „ìš© ì„¤ì •
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: './src/setupTests.ts',
  },
});
```

- ğŸ“„ src/App.test.tsx

```ts
import { render, screen, waitFor } from '@testing-library/react';
import App from './App';

test('ì‚¬ìš©ì ì •ë³´ë¥¼ ë Œë”ë§í•œë‹¤', async () => {
  render(<App />);
  await waitFor(() => {
    expect(screen.getByText(/í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì/)).toBeInTheDocument();
  });
});
```

# ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì„ ê²½ìš°

```
Uncaught (in promise) Error: [MSW] Failed to register a Service Worker for scope ('https://your-github-id.github.io/') with script ('https://your-github-id.github.io/mockServiceWorker.js'): Service Worker script does not exist at the given path.
Did you forget to run "npx msw init <PUBLIC_DIR>"?
Learn more about creating the Service Worker script: https://mswjs.io/docs/cli/init
    at getWorkerInstance (index-CW2z-yh0.js:25297:13)
    at async startWorkerInstance (index-CW2z-yh0.js:26227:24)
    at async SetupWorkerApi.start (index-CW2z-yh0.js:27870:12)
```

í˜¹ì‹œ ê°œë°œìë„êµ¬ì˜ ë„¤íŠ¸ì›Œí¬íƒ­ì—ì„œ ìœ„ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´, `public/mockServiceWorker.js` íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•´ë³´ì.
ìˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ì—¬ì „íˆ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´,

vite.config.ts íŒŒì¼ì˜ defineConfigì— ì•„ë˜ ì½”ë“œì™€ ê°™ì´ baseì™€ testë¥¼ ì¶”ê°€í–ˆëŠ”ì§€ í™•ì¸í•´ë³´ì.

- vite.config.ts

```ts
export default defineConfig(({ mode }) => ({
  plugins: [react()],
  base: mode === 'production' ? '/react-shopping-products/' : '/',
  test: {
    globals: true,
    environment: 'jsdom',
  },
}));
```

ìœ„ ì„¤ì •ì—ì„œ,

`globals: true`ëŠ” `describe`, `it`, `expect`, `beforeEach` ê°™ì€ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤ì„ ì „ì—­(global) ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•œë‹¤.

ê·¸ë¦¬ê³  `environment: 'jsdom'`ì€ í…ŒìŠ¤íŠ¸ê°€ ì‹¤í–‰ë  í™˜ê²½ì„ ë¸Œë¼ìš°ì €ì²˜ëŸ¼ í‰ë‚´ ë‚´ëŠ” jsdomìœ¼ë¡œ ì„¤ì •í•œë‹¤.
`jsdom`ì€ ë¸Œë¼ìš°ì €ì˜ `window`, `document`, `HTMLElement`, `localStorage` ê°™ì€ ê°ì²´ë¥¼ `Node.js` í™˜ê²½ì—ì„œ ì—ë®¬ë ˆì´ì…˜í•œë‹¤.

Viteê°€ ë¹Œë“œí•œ ë¦¬ì†ŒìŠ¤ë“¤ì˜ ê²½ë¡œë¥¼ `base`ì— ë§ê²Œ ì¡°ì •í•œë‹¤.

`vite build` ì‹œ HTML ë‚´ ê²½ë¡œê°€ `/react-shopping-products/`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìƒì„±ëœë‹¤
ë”°ë¼ì„œ ì‹¤ì œ ë¹Œë“œ ê²°ê³¼ê°€ GitHub Pagesì—ì„œ ì •í™•íˆ ì‘ë™í•˜ê²Œ ëœë‹¤.

- main.tsx

```ts
async function enableMocking() {
  // if (process.env.NODE_ENV !== 'development') {
  //   return;
  // }

  const isLocalhost = location.hostname === 'localhost';

  const { worker } = await import('./mocks/browser');
  return worker.start({
    serviceWorker: {
      url: isLocalhost ? '/mockServiceWorker.js' : '/react-shopping-products/mockServiceWorker.js',
    },
    onUnhandledRequest: 'bypass',
  });
}

enableMocking().then(() => {
  ReactDOM.createRoot(document.getElementById('root')!).render(
    <React.StrictMode>
      <App />
    </React.StrictMode>
  );
});
```

ìœ„ ì„¤ì •ì€ ê°œë°œ í™˜ê²½ê³¼ ë°°í¬ í™˜ê²½ì— ë”°ë¼ ì„œë¹„ìŠ¤ ì›Œì»¤ì˜ ìœ„ì¹˜ë¥¼ ë‹¤ë¥´ê²Œ ì§€ì •í•œë‹¤.
`mockServiceWorker.js`ëŠ” `public/` ë””ë ‰í† ë¦¬ì— ë“¤ì–´ ìˆê³ , `vite.config.ts`ì—ì„œ `base`ë¥¼ ì„¤ì •í–ˆê¸° ë•Œë¬¸ì— ë°°í¬ ì‹œì—” ë‹¤ìŒê³¼ ê°™ì€ ê²½ë¡œì— ìœ„ì¹˜í•œë‹¤.

# ë§ˆë¬´ë¦¬

MSWëŠ” ë‹¨ìˆœí•œ ëª¨í‚¹ ë„êµ¬ë¥¼ ë„˜ì–´ì„œ, í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìê°€ APIì™€ ë…ë¦½ì ìœ¼ë¡œ ê°œë°œí•˜ê³  í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ê°•ë ¥í•œ ë„êµ¬ì´ë‹¤.
Vite + React í™˜ê²½ì—ì„œëŠ” êµ¬ì„±ë„ ê°„ë‹¨í•˜ë©°, ê°œë°œ/í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ë¶ ë“± ëª¨ë“  ìƒí™©ì— ëŒ€ì‘ ê°€ëŠ¥í•˜ë‹¤.
ì´ í¬ìŠ¤íŠ¸ë¥¼ í†µí•´ MSWì˜ ê¸°ë³¸ì ì¸ ì‚¬ìš©ë²•ì„ ìµí˜”ìœ¼ë‹ˆ, ì‹¤ì œ í”„ë¡œì íŠ¸ì— ì˜ ì ìš©í•´ë³´ê¸¸ ë°”ë€ë‹¤.
